import{c as y,t as A,r as h,a as v,b as F,d as S}from"./laravel-precognition-DdcDqtPE.js";import{c as u,g as p,s as C}from"./lodash-es-BeZXkzNc.js";function T(e){e.magic("form",i=>(d,o,g,E={})=>{const l=u(g),f=Object.keys(l),c=e.reactive({touched:[],valid:[]}),n=y(t=>t[v(d)](h(o),r.data(),E),l).on("validatingChanged",()=>{r.validating=n.validating()}).on("validatedChanged",()=>{c.valid=n.valid()}).on("touchedChanged",()=>{c.touched=n.touched()}).on("errorsChanged",()=>{r.hasErrors=n.hasErrors(),r.errors=A(n.errors()),c.valid=n.valid()}),m=t=>({...t,precognitive:!1,onStart:()=>{r.processing=!0,(t.onStart??(()=>null))()},onFinish:()=>{r.processing=!1,(t.onFinish??(()=>null))()},onValidationError:(a,s)=>(n.setErrors(a.data.errors),t.onValidationError?t.onValidationError(a):Promise.reject(s))}),b=()=>({...u(g),data(){const t=u(r);return f.reduce((a,s)=>({...a,[s]:t[s]}),{})},touched(t){return c.touched.includes(t)},touch(t){return n.touch(t),r},validate(t){return typeof t>"u"?n.validate():(t=F(t),n.validate(t,p(r.data(),t))),r},validating:!1,valid(t){return c.valid.includes(t)},invalid(t){return typeof r.errors[t]<"u"},errors:{},hasErrors:!1,setErrors(t){return n.setErrors(t),r},forgetError(t){return n.forgetError(t),r},reset(...t){const a=u(l);return t.length===0?f.forEach(s=>r[s]=a[s]):t.forEach(s=>C(r,s,p(a,s))),n.reset(...t),r},setValidationTimeout(t){return n.setTimeout(t),r},processing:!1,async submit(t={}){return S[v(d)](h(o),r.data(),m(t))},validateFiles(){return n.validateFiles(),r}}),r=e.reactive(b());return V(i,v(d),h(o),r),r})}const V=(e,i,d,o)=>{e instanceof Element&&e.nodeName==="FORM"&&(x(e,i),M(e,i),j(e,d),D(e,o))},M=(e,i)=>{i!=="get"&&!e.hasAttribute("method")&&e.setAttribute("method","POST")},j=(e,i)=>{e.hasAttribute("action")||e.setAttribute("action",i)},x=(e,i)=>{if(["get","post"].includes(i)||e.querySelector('input[type="hidden"][name="_method"]')!==null)return;const o=e.insertAdjacentElement("afterbegin",document.createElement("input"));o!==null&&(o.setAttribute("type","hidden"),o.setAttribute("name","_method"),o.setAttribute("value",i.toUpperCase()))},D=(e,i)=>e.addEventListener("submit",()=>i.processing=!0);export{T as p};
